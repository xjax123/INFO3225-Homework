/* autogenerated by Processing revision 1293 on 2024-01-24 */
import processing.core.*;
import processing.data.*;
import processing.event.*;
import processing.opengl.*;

import java.util.HashMap;
import java.util.ArrayList;
import java.io.File;
import java.io.BufferedReader;
import java.io.PrintWriter;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.IOException;

public class Lab2b extends PApplet {

PImage ref;
PImage flipX;
PImage flipY;
PImage comp;

public void setup() {
    /* size commented out by preprocessor */;
    ref = loadImage("CityCrest.png");
    flipX = mirrorX(ref);
    flipY = mirrorY(ref);
    comp = mirrorX(mirrorY(ref));
}

public void draw() {
    background(255);
    //Reference Image
    renderImage(ref, 0, 250, 400, 500);

    //X Flip
    renderImage(flipX, 400, 250, 400, 500);

    //Y Flip
    renderImage(flipY, 800, 250, 400, 500);
    
    //Composite
    renderImage(comp, 1450, 250, 500, 500, 0.5f, 90);
}

public void renderImage(PImage image, int x, int y, int aspectX, int aspectY, float scale, float rotation) {
    float transformFactor = 1/scale;
    pushMatrix();
    scale(scale);
    translate(x*transformFactor, y*transformFactor);
    rotate(radians(rotation));
    image(image, 0, 0, 400, 500);
    popMatrix();
}
public void renderImage(PImage image, int x, int y, int aspectX, int aspectY, float scale) {
    renderImage(image, x, y, aspectX, aspectY, scale, 0);
}
public void renderImage(PImage image, int x, int y, int aspectX, int aspectY) {
    renderImage(image, x, y, aspectX, aspectY, 1, 0);
}

public PImage mirrorX(PImage source) {
    PImage flipped = source.copy();
    flipped.loadPixels();
    for (int y = source.height-1; y >= 0; y--) {
        for (int x = 0; x < source.width; x++) {
            int opIndex = source.width-x-1;
            flipped.pixels[y*source.width + opIndex] = source.pixels[y*source.width + x];
        }
    }
    flipped.updatePixels();
    return flipped;
}

public PImage mirrorY(PImage source) {
    PImage flipped = source.copy();
    flipped.loadPixels();
    int invy = 0;
    for (int y = source.height-1; y >= 0; y--) {
        for (int x = 0; x < source.width; x++) {
            int opIndex = source.width-x-1;
            flipped.pixels[y*source.width + x] = source.pixels[invy*source.width + x];
        }
        invy +=1;
    }
    flipped.updatePixels();
    return flipped;
}


  public void settings() { size(1600, 1000); }

  static public void main(String[] passedArgs) {
    String[] appletArgs = new String[] { "Lab2b" };
    if (passedArgs != null) {
      PApplet.main(concat(appletArgs, passedArgs));
    } else {
      PApplet.main(appletArgs);
    }
  }
}
